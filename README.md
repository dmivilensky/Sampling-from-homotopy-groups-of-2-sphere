# Sampling from $\pi_n(S^2)$. Application of optimization and machine learning methods to problems of algebraic topology

## Задача

Существует формула Ву [1] для гомотопических групп
двумерной сферы:
$$\pi_n(S^2) = \frac{R_0 \cap ... \cap R_{n-1}}{[[R_0, ..., R_{n-1}]]},$$
где $R_i = \langle x_i \rangle \subset F$ — нормальная подгруппа свободной группы $F$ на $n-1$ порождающих, порождённая $x_i$ ( $i=1, ..., n-1$ ), $R_0 = \langle x_1 x_2 ... x_{n-1} \rangle \subset F$, а $[[R_0, ..., R_{n-1}]] = \Pi_{\pi \in S_n} [R_{\pi(0)}, ..., R_{\pi(n-1)}]$ – симметрический коммутант. Следуя этой формуле, мы пытаемся решить задачу получения элементов гомотопической группы, отождествляемых в данном случае с некоторыми элементами свободной группы $F$. Элементы свободной группы могут быть записаны в виде слов над алфавитом $\{ x_1, ..., x_{n-1}, x_1^{-1}, ..., x_{n-1}^{-1} \}$, достаточно удобного объекта для применения вычислительных алгоритмов, при этом получение элементов из $R_i$ (проверка принадлежности элемента к $R_i$) сравнительно просто. Существенно сложным оказывается получение элементов из пересечения $R_i$ (числитель формулы) и проверка их принадлежности симметрическому коммутанту (её знаменатель) — явного алгоритма решения этих задач нет. Мы предлагаем различные приближенные алгоритмы, привлекая большое разнообразие подходов из теории оптимизации и практики применения нейронных сетей к задачам NLP.

- [1] Jie Wu. "Combinatorial descriptions of homotopy groups of certain spaces". В: Mathematical Proceedings of the Cambridge Philosophical Society. Т. 130. 3. Cambridge University Press. 2001, с. 489—513.
- [2] Ralph Fox. "Free Differential Calculus, I: Derivation in the Free Group Ring". Annals of Mathematics. Т. 57. 3. 1953, с. 547–560.

## Статус

### Работа с группами

#### Модуль имплементирован

- Генерирование слов, представляющих элементы из свободной группы, нормальных подгрупп; редукция; проверка принадлежности слова нормальной подгруппе ```group_tool.reduced_words```;
- Автоматическое вычисление производных Фокса [2] ```group_tool.fox_derivatives```.

#### Имплементация приостановлена

- Генерирование выражений из коммутаторов, процесс Холла сбора коммутатора.

### Сэмплирование из пересечения нормальных подгрупп (числитель формулы)

#### Метод имплементирован

- Случайное генерирование слов из свободной группы и фильтрация путём непосредственной проверки принадлежности к нужным подгруппам ```sampling.trivial_sampler```;
- Глобальная оптимизация с помощью (1+1)-эволюционного алгоритма приближенного расстояния до пересечения подгрупп $\Sigma_{i=0}^{n-1} d(x, R_i)$, где $d(x, R_i)$ равно длине редуцированного слова после подстановки $x_i \to e$ или $x_1 \to x_{n-1}^{-1} \dots x_2^{-1}$ ```sampling.evolutionary_sampler```;
- Глобальная непрерывная оптимизация с помощью метода мультистарта и градиентного спуска с клиппингом расстояния до нейтрального элемента в представлениях Санова после соответствующих подстановок ```sampling.matrix_sampler```;
- Обучение ансамбля нейронных сетей архитектуры LSTM генерированию следующей буквы в слове, минимизирующему дивергенцию Кульбака-Лейблера с эмпирическим распределением ```sampling.language_model_sampler```;
- Обучение нейросети архитектуры Transformer генерированию следующей буквы в слове, минимизирующему дивергенцию Кульбака-Лейблера с эмпирическим распределением;
- Обучение с подкреплением генеративно-состязательной нейронной сети генерированию слов, с высокой вероятностью принадлежащих нормальной подгруппе.

#### Исследование приостановлено

- Непрерывная оптимизация расстояния до пересечения подгрупп при квазиизометрическом вложении графа Кэли свободной группы в гиперболическое пространство ```embedding```;
- Максимизация активации нейронной сети, обученной проверять принадлежность слова нормальной подгруппе ```sampling.activation_maximization_sampler```.

## Права

Copyright © 2020–2022 Фёдор Павутницкий, Дмитрий Пасечнюк, Кирилл Бриллиантов и Герман Магай
